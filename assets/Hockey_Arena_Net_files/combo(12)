YUI.add("flickr-products-books-updateBook-updater",function(e,t){"use strict";function n(t,n){return e.batch(n.getModel("book-models",t),n.getModelRegistry("page-models")).then(function(e){var t,r={},i,s=e[0],o=e[1];return t={id:""+s.id,owner:n.getViewer().nsid,title:s.getValue("title")},i=s.getValue("pageOrder"),t.count_pages=i.length-1,i.forEach(function(e,t){var n,i={},s,u;s=o.proxy(e),n={id:s.id,page_number:s.getValue("pageNumber")+"",count_photos:s.getValue("countPhotos")+"",template:s.getValue("template")+"",background_color:s.getValue("backgroundColor")},u=s.getValue("pagePhotos").getList(),u=u.forEach(function(e,t){var n;e.getValue("photo")&&(n={id:e.getValue("photo").id,position:t+1+"",crop_x:e.getValue("cropX")*100+"",crop_y:e.getValue("cropY")*100+"",crop_w:e.getValue("cropW")*100+"",crop_h:e.getValue("cropH")*100+"",low_quality:e.getValue("isLowQuality"),is_invalid_for_print:e.getValue("isInvalidForPrint")},i[t+1]=n)}),n.photos=i,r[t]=n}),t.pages=r,t})}function r(n,r,i){var s=this;return this.serialize(n,r).then(function(i){return r.callAPI("flickr.products.books.updateBook",{book:JSON.stringify(i)}).then(function(t){if(t[0]&&t[0].badPhotos)e.fire("bookUpdater:failure",{badPhotos:t[0].badPhotos});else if(s.pendingUpdate)return s.pendingUpdate=!1,s.startNextUpdate(n,r)},function(e){throw s.pendingUpdate&&(s.pendingUpdate=!1),e}).then(null,e.FetcherErrorLogger(t))})}function i(){return this.updateInFlight=null,!0}function s(e,t){return this.updateInFlight=this.callAPI(e,t).then(this.clearUpdateInFlight.bind(this),this.clearUpdateInFlight.bind(this)),this.updateInFlight}function o(e,t){return this.pendingUpdate=null,this.startUpdate(e,t)}function u(e,t){var n=e.bookId;return this.pendingUpdate?this.updateInFlight:this.updateInFlight?(this.pendingUpdate=!0,this.updateInFlight):this.startUpdate(n,t)}e.namespace("ModelUpdaters")["flickr-products-books-updateBook"]={run:u,serialize:n,callAPI:r,clearUpdateInFlight:i,startUpdate:s,startNextUpdate:o}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["page-models","book-models","book-page-photo-models"]});
YUI.add("api-products-books-helper",function(e){function t(t,n,r,i){var s=t.book,o,u,a=[];s&&(u={id:s.id,owner:s.owner,title:s.title,coverPhotoId:s.coverPhotoId},s.page&&e.Array(s.page).forEach(function(t){n.exists(t.id)?o=e.APIHelper.response.parsePage(t):n.add(e.APIHelper.response.parsePage(t)),a.push(n.proxy(t.id))}),u.pages=a,r.exists(u.id)?r.setValues(u.id,{title:u.title,pages:u.pages,coverPhotoId:u.coverPhotoId}):r.add(u))}e.APIProductsBooksHelper={processDefaultResponse:t}},"@VERSION@",{requires:["flickr-promise","api-helper","api-products-books-helper"],optional:["page-models","book-models"]});
YUI.add("flickr-products-books-editBook-updater",function(e,t){"use strict";function n(n,r){var i={};return i.book_id=n.bookId,i.title=n.title,e.Promise.all([r.callAPI("flickr.products.books.editBook",i),r.getModelRegistry("book-models")]).then(null,e.FetcherErrorLogger(t))}e.namespace("ModelUpdaters")["flickr-products-books-editBook"]={run:n}},"@VERSION@",{requires:["flickr-promise","api-helper","api-products-books-helper"],optional:["page-models","book-models"]});
YUI.add("flickr-products-books-creator",function(e,t){"use strict";function n(t){var n={};return t=t||{},n=t,n.cacheBust=Date.now(),n.extras=e.APIHelper.request.getRebootPhotoExtras(),n}function r(t,n){var r,i;return r={pageModelRegistry:t.pageModelRegistry,bookModelRegistry:t.bookModelRegistry,pagePhotoModelRegistry:t.pagePhotoModelRegistry,photoModelRegistry:t.photoModelRegistry,personRegistry:t.personRegistry,photoEngagementRegistry:t.photoEngagementRegistry,photoStatsRegistry:t.photoStatsRegistry},i=e.ProductsAPIHelper.parseBook(t.response.book,r),i}function i(n,r){var i=this;return(new e.FlickrPromise({response:r.callAPI("flickr.products.books.create",this._processParams(n)),pageModelRegistry:r.getModelRegistry("page-models"),bookModelRegistry:r.getModelRegistry("book-models"),pagePhotoModelRegistry:r.getModelRegistry("book-page-photo-models"),photoModelRegistry:r.getModelRegistry("photo-models"),personRegistry:r.getModelRegistry("person-models"),photoEngagementRegistry:r.getModelRegistry("photo-engagement-models"),photoStatsRegistry:r.getModelRegistry("photo-stats-models")})).then(function(e){return i._processResponse(e,n)},e.FetcherErrorLogger(t))}e.namespace("ModelCreators")["flickr-products-books-creator"]={run:i,_processParams:n,_processResponse:r}},"@VERSION@",{requires:["flickr-promise","api-helper","products-api-helper"],optional:["page-models","book-models","book-page-photo-models","photo-models","person-models","photo-engagement-models"]});
YUI.add("book-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-products-books"].run(t,this.appContext)},update:function(t,n){return"title"in n?e.ModelUpdaters["flickr-products-books-editBook"].run({bookId:t,title:n.title.newVal},this.appContext):e.ModelUpdaters["flickr-products-books-updateBook"].run({bookId:t},this.appContext)},create:function(t){return e.ModelCreators["flickr-products-books-creator"].run(t,this.appContext)}},movePage:function(e,t,n,r){var i,s,o,u;return i=this.getValue(e,"pageOrder"),s=i.length,t<s&&n<s&&(r?u=i.splice(t,2):u=i.splice(t,1)[0],o=[n,0].concat(u),Array.prototype.splice.apply(i,o)),this.setValue(e,"pageOrder",i),i},addPage:function(e,t,n){var r,i;return r=this.getValue(e,"pageOrder"),i=r.length,n<=i&&r.splice(n+1,0,t),this.setValue(e,"pageOrder",r),r},removePage:function(e,t){var n,r,i,s;return n=this.getValue(e,"pageOrder"),s=n.length,r=n.indexOf(t),r<s&&(i=n.splice(r,1),this.setValue(e,"pageOrder",n)),n},attributes:{title:{},owner:{},pageOrder:{},coverPage:{isModel:!0},totalPhotos:{},price:{},lastPageViewed:{},created:{getter:function(e){return parseInt(e,10)}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-products-books-fetcher","flickr-products-books-updateBook-updater","flickr-products-books-editBook-updater","flickr-products-books-creator"]});
YUI.add("flickr-products-books-addPage-creator",function(e,t){"use strict";function n(t){var n={book_id:t.bookId};return t.photoIds&&(n.photo_ids=t.photoIds.join(","),n.extras=e.APIHelper.request.getRebootPhotoExtras()),e.Lang.isNumber(t.templateId)&&(n.template_id=t.templateId),t.backgroundColor&&(n.background_color=t.backgroundColor),n}function r(t,n,r){var i=t[0],s=t[1],o=t[2],u=t[3],a=t[4],f=t[5],l=t[6],c=[],h,p=i.page,d,v;return p.photo&&e.Array(p.photo).forEach(function(t){var r,i,s,f,h;h=p.id+"_"+t.position,r={id:h,bookId:n.bookId,position:t.position,cropX:t.cropX/100,cropY:t.cropY/100,cropW:t.cropW/100,cropH:t.cropH/100,invalidForPrintReason:t.invalidForPrintReason,isInvalidForPrint:t.isInvalidForPrint},i=e.APIHelper.response.parsePhoto(t),s=i.owner,f=i.engagement,d=s.id,a.exists(d)?(delete s.id,a.setValues(d,s)):a.add(s),i.owner=a.proxy(d),d=f.id,l.exists(d)?(delete f.id,l.setValues(d,f)):l.add(f),i.engagement=l.proxy(d),d=i.id,u.exists(d)?(delete i.id,u.setValues(d,i)):u.add(i),r.photo=u.proxy(d),d=r.id,o.exists(d)?(delete r.id,o.setValues(d,r)):o.add(r),c.push(o.proxy(d))}),v=e.APIHelper.response.parsePage(p),v.pagePhotos=c,v.bookId=n.bookId,d=v.id,s.exists(d)?(delete v.id,s.setValues(d,v),h=s.proxy(d)):h=s.add(v),f.proxy(n.bookId).getValue("pages").appendToList(h),h}function i(n,r){var i=this;return e.Promise.all([r.callAPI("flickr.products.books.addPage",this._processParams(n)),r.getModelRegistry("page-models"),r.getModelRegistry("book-page-photo-models"),r.getModelRegistry("photo-models"),r.getModelRegistry("person-models"),r.getModelRegistry("book-models"),r.getModelRegistry("photo-engagement-models")]).then(function(e){return i._processResponse(e,n,r)},e.FetcherErrorLogger(t))}e.namespace("ModelCreators")["flickr-products-books-addPage"]={run:i,_processParams:n,_processResponse:r}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["page-models","book-models","book-page-photo-models","photo-models","person-models","photo-engagement-models"]});
YUI.add("flickr-products-books-removePage-deletor",function(e,t){"use strict";function n(e,t){var n=e[1],r=e[0],i=n.book,s;i&&(s={id:i.id,price:i.price},r.exists(s.id)&&r.setValues(s.id,{price:s.price}))}function r(n,r,i){var s={},o=this;return s.page_id=n,s.book_id=r,e.Promise.all([i.getModelRegistry("book-models"),i.callAPI("flickr.products.books.removePage",s)]).then(function(e){return o._processResponse(e)},e.FetcherErrorLogger(t))}e.namespace("ModelDeletors")["flickr-products-books-removePage"]={run:r,_processResponse:n}},"@VERSION@",{requires:["flickr-promise"],optional:[]});
YUI.add("page-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-products-books-getPage"].run(t,this.appContext)},update:function(t,n){return e.ModelUpdaters["flickr-products-books-updateBook"].run({bookId:this.getValue(t,"bookId")},this.appContext)},create:function(t){return e.ModelCreators["flickr-products-books-addPage"].run(t,this.appContext)},"delete":function(t){return e.ModelDeletors["flickr-products-books-removePage"].run(t,this.getValue(t,"bookId"),this.appContext)}},forceUpdate:function(t){return e.ModelUpdaters["flickr-products-books-updateBook"].run({bookId:this.getValue(t,"bookId")},this.appContext)},attributes:{bookId:{getter:function(e){return parseInt(e,10)},validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},backgroundColor:{defaultValue:"255,255,255"},pageNumber:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},template:{getter:function(e){return parseInt(e,10)},validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0},countPhotos:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0},pagePhotos:{isListProxy:!0}}})},"@VERSION@",{requires:["flickr-products-books-editPage-updater","flickr-products-books-getPage-fetcher","flickr-products-books-addPage-creator","flickr-products-books-removePage-deletor","flickr-model-registry","flickr-promise"]});
YUI.add("flickr-products-books-fetcher",function(e,t){"use strict";function n(t){t.page=t.page||1,t.perPage=t.perPage||100;var n;return n={book_id:t.id,extras:e.APIHelper.request.getRebootPhotoExtras()},n}function r(t,n){var r,i;return r={pageModelRegistry:t.pageModelRegistry,bookModelRegistry:t.bookModelRegistry,pagePhotoModelRegistry:t.pagePhotoModelRegistry,photoModelRegistry:t.photoModelRegistry,personRegistry:t.personRegistry,photoEngagementRegistry:t.photoEngagementRegistry,photoStatsRegistry:t.photoStatsRegistry},i=e.ProductsAPIHelper.parseBook(t.response.book,r),i}function i(n,r){var i=this;return(new e.FlickrPromise({response:r.callAPI("flickr.products.books.getBook",this._processParams(n)),pageModelRegistry:r.getModelRegistry("page-models"),bookModelRegistry:r.getModelRegistry("book-models"),pagePhotoModelRegistry:r.getModelRegistry("book-page-photo-models"),photoModelRegistry:r.getModelRegistry("photo-models"),personRegistry:r.getModelRegistry("person-models"),photoEngagementRegistry:r.getModelRegistry("photo-engagement-models"),photoStatsRegistry:r.getModelRegistry("photo-stats-models")})).then(function(e){return i._processResponse(e,n)},e.FetcherErrorLogger(t))}e.namespace("ModelFetchers")["flickr-products-books"]={run:i,_processResponse:r,_processParams:n}},"@VERSION@",{requires:["flickr-promise","api-helper","products-api-helper"],optional:["page-models","book-models","book-page-photo-models","photo-models","person-models","photo-engagement-models"]});
YUI.add("basic-book-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,attributes:{title:{},owner:{},coverPhoto:{isModel:!0},coverPhotoDeleted:{defaultFn:function(){return!1}},cropW:{setter:function(e){return Math.abs(e)||0},getter:function(e){return parseFloat(e,10)||0},defaultFn:function(){return 0},defaultValue:0},cropH:{setter:function(e){return Math.abs(e)||0},getter:function(e){return parseFloat(e,10)||0},defaultFn:function(){return 0},defaultValue:0},cropX:{setter:function(e){return Math.abs(e)||0},getter:function(e){return parseFloat(e,10)||0},defaultFn:function(){return 0},defaultValue:0},cropY:{setter:function(e){return Math.abs(e)||0},getter:function(e){return parseFloat(e,10)||0},defaultFn:function(){return 0},defaultValue:0},totalPages:{},created:{getter:function(e){return parseInt(e,10)}},updated:{getter:function(e){return parseInt(e,10)}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-products-books-fetcher","flickr-products-books-updateBook-updater","flickr-products-books-editBook-updater"]});
YUI.add("flickr-creations-fetcher",function(e,t){"use strict";function n(t){var n={extras:e.APIHelper.request.getRebootPhotoExtras()};return n}function r(t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=t[4],a=t[5],f=t[6],l=t[7],c=t[8],h=[],p=[],d=[];return r&&r.stat==="ok"&&(h=Object.keys(r.wallart_ids).map(function(e){return r.wallart_ids[e]}),e.Array.each(h,function(t,n){if(t.photoSource===2)return;var r,i,s,u=[],h=!1,d,v,m,g={};r=a.addOrUpdate({id:t.owner}),t.photo.id?(g={photos:[t.photo],personModelRegistry:a,photoModelRegistry:f,photoEngagementModelRegistry:l,photoStatsModelRegistry:c},t.photo.ownerId&&(g.ownerID=t.photo.ownerId),i=e.APIHelper.response.parsePhotos(g)[0]):h=!0,t.orders&&typeof t.orders=="object"&&(s=Object.keys(t.orders).map(function(e){return t.orders[e]}),e.Array.each(s,function(e){u.push({orderId:e.orderId,orderStatus:e.order.statusOrder,dateCreate:e.dateCreate,dateUpdate:e.dateUpdate})})),t.skuId.substr(-2)==="CC"?(d=t.skuId.slice(0,-3),v=!0):t.skuId.substr(-2)==="MK"?(d=t.skuId.slice(0,-3),m=!0):d=t.skuId,p.push(o.addOrUpdate({id:t.wallartId,owner:r,photo:i,photoDeleted:h,skuId:d,isCC:v,isMK:m,orientation:t.orientation,price:t.price,cropW:t.photo.cropW,cropH:t.photo.cropH,cropX:t.photo.cropX,cropY:t.photo.cropY,isEditable:t.isEditable,isLowQuality:t.isLowQuality,created:t.dateCreate,updated:t.dateUpdate,orders:u,photoSource:t.photoSource}))})),i&&i.stat==="ok"&&e.Array.each(i.books.book,function(t,n){var r=!1,i,s;i=a.addOrUpdate({id:t.owner}),t.coverPhoto.id?s=e.APIHelper.response.parsePhotos({photos:[t.coverPhoto],personModelRegistry:a,photoModelRegistry:f,photoEngagementModelRegistry:l,photoStatsModelRegistry:c})[0]:r=!0,d.push(u.addOrUpdate({id:t.id,title:t.title,owner:i,coverPhoto:s,coverPhotoDeleted:r,totalPages:t.countPages,created:t.dateCreate,updated:t.dateUpdate,cropW:t.coverPhoto.cropW/100,cropH:t.coverPhoto.cropH/100,cropX:t.coverPhoto.cropX/100,cropY:t.coverPhoto.cropY/100}))}),s.addOrUpdate({id:n.id,wallarts:p,books:d}),{wallarts:p,books:d}}function i(n,r){var i=this,s=this._processParams(n);return e.Promise.all([r.callAPI("flickr.products.wallart.getList",s,!0),r.callAPI("flickr.products.books.getList",s,!0),r.getModelRegistry("creations-models"),r.getModelRegistry("wallart-models"),r.getModelRegistry("basic-book-models"),r.getModelRegistry("person-models"),r.getModelRegistry("photo-models"),r.getModelRegistry("photo-engagement-models"),r.getModelRegistry("photo-stats-models")]).then(function(e){return i._processResponse(e,n)},e.FetcherErrorLogger(t))}e.namespace("ListFetchers")["flickr-creations"]={run:i,_processParams:n,_processResponse:r}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["creations-models","wallart-models","basic-book-models","person-models","photo-models","photo-engagement-models","photo-stats-models"]});
YUI.add("creations-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ListFetchers["flickr-creations"].run(t,this.appContext)}},removeCreations:function(t,n){var r=this;n.wallarts&&e.Array.each(n.wallarts,function(e,n){r.getValue(t,"wallarts").remove(e)}),n.books&&e.Array.each(n.books,function(e,n){r.getValue(t,"books").remove(e)})},appendCreations:function(t,n){var r=this;n.wallarts&&e.Array.each(n.wallarts,function(e,n){r.getValue(t,"wallarts").unshift(e)})},attributes:{wallarts:{isCollection:!0},books:{isCollection:!0}}})},"@VERSION@",{requires:["flickr-promise","model-proxy","flickr-model-registry","flickr-creations-fetcher"],optional:["wallart-models","basic-book-models"]});
YUI.add("flickr-products-wallart-create-creator",function(e,t){"use strict";function r(e){var t={};return e=e||{},t.photo_id=e.photoId,t.sku_id=e.skuId,t}function i(e,t,r){var i=e[0],s=e[1],o=e[2],u=e[3],a=t.nsid,f,l,c,h,p=!1,d=!1,v=e[4],m,g;return i?(f=i.wallart,c=o.exists(a)?o.proxy(a):o.add({id:a}),l=u.exists(t.photoId)?u.proxy(t.photoId):u.add({id:t.photoId}),f.skuId.substr(-2)==="CC"?(h=f.skuId.slice(0,-3),p=!0):f.skuId.substr(-2)==="MK"?(h=f.skuId.slice(0,-3),d=!0):h=f.skuId,s.exists(f.wallartId)?(s.setValues(f.wallartId,{owner:c,photo:l,skuId:h,isCC:p,isMK:d,orientation:f.orientation,photoSource:f.photoSource}),g=s.proxy(f.wallartId)):g=s.add({id:f.wallartId,owner:c,photo:l,skuId:h,isCC:p,isMK:d,orientation:f.orientation,created:f.dateCreate,photoSource:f.photoSource}),v.exists(a)&&(m=v.proxy(a),m.appendCreations({wallarts:[s.proxy(f.wallartId)]}))):(n.warn("No API response?"),g=this),g}function s(n,r){var i=this;return e.Promise.all([r.callAPI("flickr.products.wallart.create",this._processParams(n)),r.getModelRegistry("wallart-models"),r.getModelRegistry("person-models"),r.getModelRegistry("photo-models"),r.getModelRegistry("creations-models")]).then(function(e){return i._processResponse(e,n,r)},e.FetcherErrorLogger(t))}var n=require("lib/flog")(t);e.namespace("ModelCreators")["flickr-products-wallart-create"]={run:s,_processParams:r,_processResponse:i}},"@VERSION@",{requires:["flickr-promise","wallart-models"],optional:["person-models","photo-models","creations-models"]});
YUI.add("flickr-products-wallart-editWallart-updater",function(e,t){"use strict";function n(e,t,n){var r=e.response,i=e.wallartModelRegistry;i.exists(t)&&i.setValue(t,"price",r.wallart.price);if(this.pendingUpdate)return this.pendingUpdate=!1,this.startNextUpdate(t,n)}function r(e,t){return t.getModel("wallart-models",e).then(function(e){var t,n,r,i,s;return n=e.getValue("photo"),i=e.getValue("isCC"),s=e.getValue("isMK"),r=e.getValue("skuId"),i===!0?r+="_CC":s===!0&&(r+="_MK"),t={wallart_id:e.id,photo:{id:n.getValue("id"),owner:n.getValue("owner").getValue("id"),crop_x:e.getValue("cropX"),crop_y:e.getValue("cropY"),crop_h:e.getValue("cropH"),crop_w:e.getValue("cropW")},sku_id:r,orientation:e.getValue("orientation"),is_low_quality:e.getValue("isLowQuality")},{wallart:JSON.stringify(t)}})}function i(n,r){var i=this;return this.serialize(n,r).then(function(s){return(new e.FlickrPromise({response:r.callAPI("flickr.products.wallart.update",s),wallartModelRegistry:r.getModelRegistry("wallart-models")})).then(function(e){return i.processResponse(e,n,r)},function(e){throw i.pendingUpdate&&(i.pendingUpdate=!1),e}).then(null,e.FetcherErrorLogger(t))})}function s(){return this.updateInFlight=null,!0}function o(e,t){return this.updateInFlight=this.callAPI(e,t).then(this.clearUpdateInFlight.bind(this),this.clearUpdateInFlight.bind(this)),this.updateInFlight}function u(e,t){return this.pendingUpdate=null,this.startUpdate(e,t)}function a(e,t){return this.pendingUpdate?this.updateInFlight:this.updateInFlight?(this.pendingUpdate=!0,this.updateInFlight):this.startUpdate(e,t)}e.namespace("ModelUpdaters")["flickr-products-wallart-editWallart"]={run:a,serialize:r,callAPI:i,clearUpdateInFlight:s,startUpdate:o,processResponse:n,startNextUpdate:u}},"@VERSION@",{requires:["flickr-promise"],optional:[]});
YUI.add("wallart-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-products-wallart"].run(t,this.appContext)},create:function(t){return e.ModelCreators["flickr-products-wallart-create"].run(t,this.appContext)},update:function(t,n){return e.ModelUpdaters["flickr-products-wallart-editWallart"].run(t,this.appContext)}},attributes:{owner:{isModel:!0},photo:{isModel:!0},photoDeleted:{defaultFn:function(){return!1}},isCC:{defaultFn:function(){return!1}},isMK:{defaultFn:function(){return!1}},photoSource:{},skuId:{},orientation:{},price:{},cropW:{setter:function(e){return Math.abs(parseFloat(e,10))},defaultFn:function(){return 0}},cropH:{setter:function(e){return Math.abs(parseFloat(e,10))},defaultFn:function(){return 0}},cropX:{setter:function(e){return Math.abs(parseFloat(e,10))},defaultFn:function(){return 0}},cropY:{setter:function(e){return Math.abs(parseFloat(e,10))},defaultFn:function(){return 0}},isLowQuality:{defaultFn:function(){return 0}},isEditable:{defaultFn:function(){return!0}},isDeleted:{defaultFn:function(){return!1}},invalidForPrintReason:{},isInvalidForPrint:{},created:{getter:function(e){return parseInt(e,10)}},updated:{getter:function(e){return parseInt(e,10)}},orders:{}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-products-wallart-fetcher","flickr-products-wallart-create-creator","flickr-products-wallart-editWallart-updater"]});
YUI.add("flickr-products-wallart-fetcher",function(e,t){"use strict";function n(t){var n={wallart_id:t.id,return_deleted:1,extras:e.APIHelper.request.getRebootPhotoExtras()};return n}function r(t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=t[4],a=t[5],f=r.wallart,l,c,h,p,d=!1,v=!1,m={};if(f)return h=s.addOrUpdate({id:f.owner}),m={photos:[f.photo],personModelRegistry:s,photoModelRegistry:o,photoEngagementModelRegistry:u,photoStatsModelRegistry:a},f.photo.ownerId&&(m.ownerID=f.photo.ownerId),c=e.APIHelper.response.parsePhotos(m)[0],f.skuId.substr(-2)==="CC"?(p=f.skuId.slice(0,-3),d=!0):f.skuId.substr(-2)==="MK"?(p=f.skuId.slice(0,-3),v=!0):p=f.skuId,l={id:f.wallartId,owner:h,photo:c,skuId:p,isCC:d,isMK:v,orientation:f.orientation,price:f.price,cropW:f.photo.cropW,cropH:f.photo.cropH,cropX:f.photo.cropX,cropY:f.photo.cropY,isEditable:f.isEditable,isDeleted:f.isDeleted,isLowQuality:f.isLowQuality,photoSource:f.photoSource,created:f.dateCreate},i.addOrUpdate(l),l}function i(n,r){var i=this;return e.Promise.all([r.callAPI("flickr.products.wallart.getDetails",this._processParams(n)),r.getModelRegistry("wallart-models"),r.getModelRegistry("person-models"),r.getModelRegistry("photo-models"),r.getModelRegistry("photo-engagement-models"),r.getModelRegistry("photo-stats-models")]).then(function(e){return i._processResponse(e,n)},e.FetcherErrorLogger(t))}e.namespace("ModelFetchers")["flickr-products-wallart"]={run:i,_processResponse:r,_processParams:n}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["wallart-models","photo-models","person-models","photo-engagement-models","photo-stats-models"]});
YUI.add("photo-engagement-view",function(e,t){var n=require("lib/flog")(t);e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.photoId=e.photoId,this.nsid=e.nsid,this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this.signinPendingQueue=e.signinPendingQueue,this},subviewConfig:{"fave-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,hideWhoFaved:!0},"photo-well-scrappy-edit-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"fluid-share-photo-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"photo-sidebar-toggle-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,inlineStyling:!0,disabled:function(){return!this.appContext.flipper.isFlipped("enable-similarity-search-from-photo-page")}}},loadState:function(){var e=this;return this.appContext.getModel("photo-models",e.photoId).then(function(t){e.set("photo",t)})},buildContainer:function(){var e=this.get("photo"),t=e.getValue("owner"),n=this.get("container"),r;return r={"share-view":this.subviews["fluid-share-photo-view"]?this.subviews["fluid-share-photo-view"].get("container"):"",photoId:e.getValue("id"),ownerId:e.getValue("owner").getValue("id"),isVideo:e.getValue("isVideo"),viewerIsOwner:t.getValue("isMe"),canCreateWallart:this.canCreateWallart(),isWallartLowQuality:this.isWallartLowQuality(),downloadingAvailable:!1,downloadLink:"",hasFullScreenButton:this.appContext.flipper.isFlipped("enable-similarity-search-from-photo-page")},e.getValue("isVideo")?(r.downloadLink="/video_download.gne?id="+e.getValue("id"),this.appContext.flipper.isFlipped("enable-album-download")&&(r.downloadingAvailable=e.getValue("engagement").getValue("canDownload")),t.getValue("isMe")&&(r.downloadingAvailable=!0)):(r.downloadLink=e.getValue("url")+"/sizes/l/",r.downloadingAvailable=!0),this.appContext.forceServerRender&&(r.downloadItems=this.getDownloadMenuItems()),this.setContainerWithTemplate("photo-engagement",r),r.canCreateWallart&&n.addClass("has-wallart"),r.hasFullScreenButton&&n.addClass("has-fullscreen"),this},activate:function(){var e=this.get("photo").getValue("license"),t=e!==0&&e!==7&&e!==8&&e!==10,n=e===8,r=e===9,i=e===10,s=this.get("container");if(this.signinPendingQueue&&this.signinPendingQueue.length>0){var o=this.signinPendingQueue;for(var u=0;u<o.length;u++)o[u].key==="download"&&o[u].value&&o[u].value.id===this.photoId&&this.downloadItem(o[u].value.imageUrl)}return this.appContext.flipper.isFlipped("enable-signed-out-download-cta-test")&&!this.appContext.getViewer().signedIn&&!this.appContext.getUA().isBot&&this.get("photo").getValue("owner").getValue("isPro")!==!0&&!t&&!n&&!r&&!i&&this.get("photo").getValue("visibilitySource")!==2&&(this.signedOutTest=!0),s.all(".sizes li a.download-image-size")&&this.registerEventHandler(s.all(".sizes li a.download-image-size").on("click",this.handleDownloadItemClick,this)),this.attachKeyEvent("down:68",this.handleDownloadMenuButtonClick.bind(this)),this.registerEventHandler(s.delegate("click",this.handleDownloadMenuButtonClick.bind(this),".download a")),this.registerEventHandler(s.delegate("click",this.createWallartClick.bind(this),".wallart a")),this.signedOutTest&&s.one(".all-sizes")&&this.registerEventHandler(s.one(".all-sizes").on("click",function(e){e.halt(),this.signUpAndDownloadItem()}.bind(this))),this},canCreateWallart:function(){var e=!1,t,n=this.appContext.getViewer(),r,i;return t=this.get("photo"),t&&n&&(r=t.getValue("owner").getValue("isMe"),i=!t.getValue("isVideo"),n.signedIn&&r&&i&&(e=!0)),e},isWallartLowQuality:function(){var t=this.get("photo");return this.wallartHelper||(this.wallartHelper=new e.WallartHelper),this.wallartHelper.isPhotoWallartable(t).skus.length===0?!0:!1},createWallartClick:function(n){var r=this,i="/create/wallart/",s=this.get("photo"),o;n.halt(),e.rapidTracker.beacon(t,"createWallartClick");if(s.getValue("hasInvalidColorspaceForPrint"))return this.handleLacksWallartability("COLORSPACE");this.wallartHelper||(this.wallartHelper=new e.WallartHelper(this.appContext));if(this.wallartHelper.isPhotoWallartable(s).skus.length===0)return this.handleLacksWallartability("LOW_QUALITY");this.appContext.getModelRegistry("wallart-models").then(function(t){t.remoteCreate({nsid:r.appContext.getViewer().nsid,photoId:s.getValue("id")}).then(function(t){i+=t.getValue("id")+"/edit",YUI.Env.isServer||(!r.appContext.secure&&window.location.host===e.config.flickr.url.host?e.config.win.location.href=i:r.appContext.flapp.navigate(i))},function(t){o=new e.Views.FluidModal({appContext:r.appContext,darkOverlay:!0,dismissOnOverlayClick:!0,actionButtonLabel:r.intlMessage({intlName:"common.OK"}),title:r.intlMessage({intlName:"common.UPLOAD_ERROR_TITLE"}),message:"There was a problem creating your wall art. Please try again later."}),o.show()})})},handleLacksWallartability:function(t){var n,r;t==="LOW_QUALITY"?r="Looks like this photo doesn't meet the minimum requirements to get printed. Please choose a photo that's at least 975 &times; 825 pixels. Learn more about <a href='http://help.yahoo.com/kb/index?page=content&y=PROD_FLICKR&locale=en_US&id=SLN22567'>requirements</a> for print products.":t==="COLORSPACE"&&(r="Sorry, we cannot print photos with a CMYK or ProPhoto RGB colorspace. We recommend photos with an sRGB color space. <a href='https://help.yahoo.com/kb/flickr/creations-faq-sln22216.html?impressions=true#cont33'>Learn more</a>."),n=new e.Views.FluidModal({appContext:this.appContext,dismissOnOverlayClick:!0,dismissOnActionClick:!0,showCancelButton:!1,showCancelX:!0,title:"Try a different photo",message:r,classList:"lacks-wallartability"}),n.show()},getDownloadMenuItems:function(t){var n=e.clone(this.get("photo").toJSON()),r,i=[],s,o=this.get("photo").getValue("engagement").getValue("canDownload"),u=!1;if(!n||!n.sizes)return"";n.sizes.q&&(n.sizes.q.label=this.intlMessage({intlName:"photo-page-scrappy.SQUARE"}),i.push(n.sizes.q)),n.sizes.s&&(n.sizes.s.label=this.intlMessage({intlName
:"photo-page-scrappy.SMALL"}),i.push(n.sizes.s)),n.sizes.z&&(n.sizes.z.label=this.intlMessage({intlName:"photo-page-scrappy.MEDIUM"}),i.push(n.sizes.z)),n.sizes.k?(n.sizes.k.label=this.intlMessage({intlName:"photo-page-scrappy.LARGE"}),i.push(n.sizes.k)):n.sizes.h?(n.sizes.h.label=this.intlMessage({intlName:"photo-page-scrappy.LARGE"}),i.push(n.sizes.h)):n.sizes.l&&(n.sizes.l.label=this.intlMessage({intlName:"photo-page-scrappy.LARGE"}),i.push(n.sizes.l)),n.sizes.o&&(n.sizes.o.label=this.intlMessage({intlName:"photo-page-scrappy.ORIGINAL"}),i.push(n.sizes.o));for(s=0;s<i.length;s++)i[s].url=i[s].displayUrl.replace(/^(.+)(\..+)$/,"$1_d$2");return o&&(u=!0),r=this.templates("scrappy-download-menu")({photo:n,sizes:i,showDownloadSizes:u}),r},createDownloadDialog:function(t){var n=this.get("container"),r=this;this.downloadMenu&&(this.downloadMenu.close(),this.downloadMenu=null),this.downloadMenu=new e.Views.FluidDroparound({appContext:this.appContext,dismissOnOverlayClick:!0,preferTop:!0,showDropArrow:!0,anchorOffsetVertical:5,anchorOffsetHorizontal:1,anchorElement:n.one(".download"),htmlMessage:t,closeOnScroll:!1,classList:"download-dialog-tooltip",hideModalOverlay:!0,autoSizeToContent:!0}),this.downloadMenu.on("activated",function(e){r.fire("subviewViewEvent","make in view",n)}),this.downloadMenu.on("closeDroparound",function(e){r.fire("subviewViewEvent","close in view")}),this.downloadMenu.show()},handleDownloadMenuButtonClick:function(n){var r=this.get("photo"),i;if(n.target.ancestor(".download",!0).hasClass("disabled"))n.preventDefault();else if(r.getValue("isVideo"))if(!this.appContext.flipper.isFlipped("enable-album-download")){i=r.getValue("owner").getValue("isMe");if(!i)return n.preventDefault(),!1}else this.handleDownloadItemClick(n);else n.halt(),this.createDownloadDialog(this.getDownloadMenuItems());e.rapidTracker.beacon(t,"downloadDialogClick")},handleDownloadItemClick:function(n){n.preventDefault();var r;r=n.currentTarget.getAttribute("href"),this.signedOutTest?this.signUpAndDownloadItem(r):this.downloadItem(r),e.rapidTracker.beacon(t,"photoDownloadClick"),this.downloadMenu.close()},downloadItem:function(e){document.location=e},signUpAndDownloadItem:function(t){var n=this,r=this.intlMessage({intlName:"photo-page-scrappy.SIGNUP_AND_DOWNLOAD_TITLE"}),i=this.intlMessage({intlName:"photo-page-scrappy.SIGNUP_AND_DOWNLOAD_MESSAGE"}),s,o;this.get("photo").getValue("isVideo")&&this.appContext.lang.toLowerCase()==="en-us"&&(r=this.intlMessage({intlName:"photo-page-scrappy.SIGNUP_AND_DOWNLOAD_VIDEO_TITLE"})),s=e.url(e.URLHelper.getPhotoPage({photoId:this.photoId,pathAlias:this.nsid})),o=new e.Views.SignUpModal({appContext:this.appContext,signUpHeaderClass:"signup-download",signUpTitle:r,signUpMessage:i,beaconPrefix:"download"}),o.on("signUpClick",function(r){t?e.SigninHelper.signUpPendingDownload({id:n.photoId,imageUrl:t},{postLoginUrl:s}):e.SigninHelper._redirectToSignUp("download",{postLoginUrl:s+"sizes/l/"})}),o.on("signInClick",function(r){t?e.SigninHelper.addPendingDownload({id:n.photoId,imageUrl:t},{postLoginUrl:s}):e.SigninHelper._redirectToSignin("download",{postLoginUrl:s+"sizes/l/"})}),o.show()}})},"@VERSION@",{requires:["flickr-view","hermes-template-photo-engagement","hermes-template-scrappy-download-menu","wallart-helper","signup-modal-view","fluid-share-photo-view","fluid-droparound-view","better-throttle"],optional:["photo-models","wallart-models"],langBundles:["common","photo-page-scrappy"]});
YUI.add("seo",function(e,t){e.Seo={appContext:{},stripTags:function(e){return e?String(e).replace(/<\/?[^>]+>/g,""):""},collapseWhitespace:function(e){return e.trim().replace(/\s+/g," ")},decodeEntities:function(e){return e.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&nbsp;/g," ")},cleanText:function(e){return this.collapseWhitespace(this.decodeEntities(this.stripTags(e)))},getSEOTitleForPhoto:function(e){var t=this.cleanText(e.getValue("title")),n=this.cleanText(e.getValue("description")),r=this.cleanText(e.getValue("owner").getValue("displayname")),i="",s="| Flickr",o=70,u=o-(t.length+s.length+5);return t.length>=50?i=t.slice(0,58)+(t.length<58?" ":"\u2026 "):t.length>20&&t.length<50?n.length>20?i=t+" | "+n.slice(0,u)+(n.length<u?" ":"\u2026 "):n.length>0?i=t+" | "+n.slice(0,u)+(n.length<u?" ":"\u2026 ")+"| "+r+" ":i=t+" | "+r+" ":t.length<=20&&t.length>0?n.length>50?i=t+" | "+n.slice(0,u)+(n.length<u?" ":"\u2026 "):n.length>0?i=t+" | "+n.slice(0,u)+(n.length<u?" ":"\u2026 ")+"| "+r+" ":i=t+" | "+r+" ":n.length>50?i=n.slice(0,u)+(n.length<u?" ":"\u2026 "):n.length>0?i=n.slice(0,u)+(n.length<u?" ":"\u2026 ")+"| "+r+" ":i="Untitled | "+r+" ",i},generateSEODescriptionForPhoto:function(e,t,n,r,i){var s=e.getValue("og:title"),o=e.getValue("og:description"),u="",a=160;return s==="Untitled"&&(s=r),o.length>120?u=o.slice(0,120)+(o.length<120?" ":"\u2026 ")+n+" "+i+".":o.length>60&&o.length<120?u=o+(o.slice(o.length-1,o.length)==="."?" ":". ")+s.slice(0,40)+(s.length<40?" ":"\u2026 ")+n+" "+i+".":o.length<=60&&(u=s+(s.slice(s.length-1,s.length)==="."?" ":". ")+o.slice(0,a-s.length)+(o.length<a-s.length?" ":"\u2026 ")+n+" "+i+"."),u}}},"@VERSION@",{requires:[]});
YUI.add("hermes-template-empty-photo-page",function(e,t){var n=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s=t!=null?t:{},o=n.helperMissing,u=e.escapeExpression;return u((n.outlet||t&&t.outlet||o).call(s,t!=null?t["global-nav-view"]:t,{name:"outlet",hash:{},data:i}))+'\n\n<div class="fluid-centered" style="text-align: center;">\n	<h3>'+u((n.intlHTMLMessage||t&&t.intlHTMLMessage||o).call(s,{name:"intlHTMLMessage",hash:{intlName:"photo-page-scrappy.TIMEOUT_FAILURE"},data:i}))+"</h3>\n</div>\n\n"+u((n.outlet||t&&t.outlet||o).call(s,t!=null?t["footer-full-view"]:t,{name:"outlet",hash:{},data:i}))+"\n"},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/empty-photo-page",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-global-nav-restyle",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){return" optimized-mobile-nav-hidden"},3:function(e,t,n,r,i){return" optimized-flickr-logo-push-left"},5:function(e,t,n,r,i){var s;return(s=n.unless.call(t!=null?t:{},(s=t!=null?t.elements:t)!=null?s.right_side_signup:s,{name:"unless",hash:{},fn:e.program(6,i,0),inverse:e.noop,data:i}))!=null?s:""},6:function(e,t,n,r,i){var s=t!=null?t:{},o=n.helperMissing,u=e.escapeExpression;return'				<li role="menuitem"\n					class="gn-signup"\n					aria-label="'+u((n.intlMessage||t&&t.intlMessage||o).call(s,{name:"intlMessage",hash:{intlName:"common.SIGN_UP"},data:i}))+'">\n					<a data-track="gnSignupClick"\n						class="gn-title butt"\n						href="/signup">'+u((n.intlMessage||t&&t.intlMessage||o).call(s,{name:"intlMessage",hash:{intlName:"common.SIGN_UP"},data:i}))+"</a>\n				</li>\n"},8:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a=e.escapeExpression;return'				<li role="menuitem"\n					data-context="you"\n					aria-label="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"common.YOU"},data:i}))+'">\n					<a data-track="gnYouMainClick"\n						class="gn-title you"\n						href="'+a(e.lambda((s=t!=null?t.viewer:t)!=null?s.url:s,t))+'"\n						aria-haspopup="true"\n						aria-expanded="false">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"common.YOU"},data:i}))+"</a>\n\n"+((s=(n.isFlipped||t&&t.isFlipped||u).call(o,"enable-updated-navigation-profile",{name:"isFlipped",hash:{},fn:e.program(9,i,0),inverse:e.program(16,i,0),data:i}))!=null?s:"")+"				</li>\n"},9:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a=e.escapeExpression,f=e.lambda;return'						<ul class="gn-submenu" role="menu" aria-label="submenu">\n							<li class="menuitem"\n								role="menuitem"\n								aria-label="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"common.ABOUT"},data:i}))+'">\n								<a data-track="gnYouAboutClick" href="'+a(f((s=(s=t!=null?t.viewer:t)!=null?s.urls:s)!=null?s.profile:s,t))+'">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"common.ABOUT"},data:i}))+'</a>\n							</li>\n							<li class="menuitem"\n								role="menuitem"\n								aria-label="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"common.PHOTOSTREAM"},data:i}))+'">\n								<a data-track="gnYouPhotostreamClick" href="'+a(f((s=t!=null?t.viewer:t)!=null?s.url:s,t))+'">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"common.PHOTOSTREAM"},data:i}))+'</a>\n							</li>\n							<li class="menuitem"\n								role="menuitem"\n								aria-label="'+((s=n["if"].call(o,(s=t!=null?t.elements:t)!=null?s.set_not_album:s,{name:"if",hash:{},fn:e.program(10,i,0),inverse:e.program(12,i,0),data:i}))!=null?s:"")+'">\n								<a data-track="gnYouSetsClick" href="'+a(f((s=(s=t!=null?t.viewer:t)!=null?s.urls:s)!=null?s.albums:s,t))+'">'+((s=n["if"].call(o,(s=t!=null?t.elements:t)!=null?s.set_not_album:s,{name:"if",hash:{},fn:e.program(10,i,0),inverse:e.program(12,i,0),data:i}))!=null?s:"")+'</a>\n							</li>\n							<li class="menuitem"\n								role="menuitem"\n								aria-label="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"common.FAVES_SHORT"},data:i}))+'">\n								<a data-track="gnYouFavoritesClick" href="'+a(f((s=(s=t!=null?t.viewer:t)!=null?s.urls:s)!=null?s.favorites:s,t))+'">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"common.FAVES_SHORT"},data:i}))+'</a>\n							</li>\n							<li class="menuitem"\n								role="menuitem"\n								aria-label="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"common.GALLERIES"},data:i}))+'">\n								<a data-track="gnYouGalleriesClick" href="'+a(f((s=(s=t!=null?t.viewer:t)!=null?s.urls:s)!=null?s.galleries:s,t))+'">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"common.GALLERIES"},data:i}))+'</a>\n							</li>\n							<li class="menuitem"\n								role="menuitem"\n								aria-label="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.GROUPS"},data:i}))+'">\n								<a data-track="gnYouGroupsClick" href="/groups">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.GROUPS"},data:i}))+"</a>\n							</li>\n"+((s=n["if"].call(o,(s=t!=null?t.elements:t)!=null?s.stats:s,{name:"if",hash:{},fn:e.program(14,i,0),inverse:e.noop,data:i}))!=null?s:"")+'\n							<li class="menuitem"\n								role="menuitem"\n								aria-label="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.CAMERAROLL"},data:i}))+'">\n								<a data-track="gnYouCameraRollClick" href="'+a(f((s=(s=t!=null?t.viewer:t)!=null?s.urls:s)!=null?s.cameraroll:s,t))+'" class="with-separator">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.CAMERAROLL"},data:i}))+'</a>\n							</li>\n							<li class="menuitem"\n								role="menuitem"\n								aria-label="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.RECENT_ACTIVITY"},data:i}))+'">\n								<a data-track="gnYouRecentActivityClick" href="/activity" class="below-separator">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.RECENT_ACTIVITY"},data:i}))+'</a>\n							</li>\n							<li class="menuitem"\n								role="menuitem"\n								aria-label="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"common.PEOPLE"},data:i}))+'">\n								<a data-track="gnYouPeopleClick" href="'+a(f((s=(s=t!=null?t.viewer:t)!=null?s.urls:s)!=null?s.people:s,t))+'">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"common.PEOPLE"},data
:i}))+'</a>\n							</li>\n							<li class="menuitem"\n								role="menuitem"\n								aria-label="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.ORGANIZE"},data:i}))+'">\n								<a data-track="gnYouOrganizeClick" href="/photos/organize">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.ORGANIZE"},data:i}))+"</a>\n							</li>\n						</ul>\n"},10:function(e,t,n,r,i){return e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlName:"common.SETS"},data:i}))},12:function(e,t,n,r,i){return e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlName:"common.ALBUMS"},data:i}))},14:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a=e.escapeExpression;return'								<li class="menuitem"\n									role="menuitem"\n									aria-label="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.STATS"},data:i}))+'">\n									<a data-track="gnYouStatsClick" href="'+a(e.lambda((s=(s=t!=null?t.viewer:t)!=null?s.urls:s)!=null?s.stats:s,t))+'">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.STATS"},data:i}))+"</a>\n								</li>\n"},16:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a=e.escapeExpression,f=e.lambda;return'						<ul class="gn-submenu" role="menu" aria-label="submenu">\n							<li class="menuitem"\n								role="menuitem"\n								aria-label="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.CAMERAROLL"},data:i}))+'">\n								<a data-track="gnYouCameraRollClick" href="'+a(f((s=(s=t!=null?t.viewer:t)!=null?s.urls:s)!=null?s.cameraroll:s,t))+'">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.CAMERAROLL"},data:i}))+'</a>\n							</li>\n							<li class="menuitem"\n								role="menuitem"\n								aria-label="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"common.PHOTOSTREAM"},data:i}))+'">\n								<a data-track="gnYouPhotostreamClick" href="'+a(f((s=t!=null?t.viewer:t)!=null?s.url:s,t))+'">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"common.PHOTOSTREAM"},data:i}))+'</a>\n							</li>\n							<li class="menuitem"\n								role="menuitem"\n								aria-label="'+((s=n["if"].call(o,(s=t!=null?t.elements:t)!=null?s.set_not_album:s,{name:"if",hash:{},fn:e.program(10,i,0),inverse:e.program(12,i,0),data:i}))!=null?s:"")+'">\n								<a data-track="gnYouSetsClick" href="'+a(f((s=(s=t!=null?t.viewer:t)!=null?s.urls:s)!=null?s.albums:s,t))+'">'+((s=n["if"].call(o,(s=t!=null?t.elements:t)!=null?s.set_not_album:s,{name:"if",hash:{},fn:e.program(10,i,0),inverse:e.program(12,i,0),data:i}))!=null?s:"")+'</a>\n							</li>\n							<li class="menuitem"\n								role="menuitem"\n								aria-label="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"common.FAVORITES"},data:i}))+'">\n								<a data-track="gnYouFavoritesClick" href="'+a(f((s=(s=t!=null?t.viewer:t)!=null?s.urls:s)!=null?s.favorites:s,t))+'">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"common.FAVORITES"},data:i}))+'</a>\n							</li>\n							<li class="menuitem"\n								role="menuitem"\n								aria-label="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.GROUPS"},data:i}))+'">\n								<a data-track="gnYouGroupsClick" href="/groups">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.GROUPS"},data:i}))+'</a>\n							</li>\n							<li class="menuitem"\n								role="menuitem"\n								aria-label="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"common.GALLERIES"},data:i}))+'">\n								<a data-track="gnYouGalleriesClick" href="'+a(f((s=(s=t!=null?t.viewer:t)!=null?s.urls:s)!=null?s.galleries:s,t))+'">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"common.GALLERIES"},data:i}))+'</a>\n							</li>\n							<li class="menuitem"\n								role="menuitem"\n								aria-label="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.CREATIONS"},data:i}))+'">\n								<a data-track="gnYouCreationsClick" href="'+a(f((s=(s=t!=null?t.viewer:t)!=null?s.urls:s)!=null?s.creations:s,t))+'">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.CREATIONS"},data:i}))+'</a>\n							</li>\n							<li class="menuitem"\n								role="menuitem"\n								aria-label="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"common.PEOPLE"},data:i}))+'">\n								<a data-track="gnYouPeopleClick" href="'+a(f((s=(s=t!=null?t.viewer:t)!=null?s.urls:s)!=null?s.people:s,t))+'">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"common.PEOPLE"},data:i}))+'</a>\n							</li>\n							<li class="menuitem"\n								role="menuitem"\n								aria-label="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.RECENT_ACTIVITY"},data:i}))+'">\n								<a data-track="gnYouRecentActivityClick" href="/activity">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.RECENT_ACTIVITY"},data:i}))+"</a>\n							</li>\n"+((s=n["if"].call(o,(s=t!=null?t.elements:t)!=null?s.stats:s,{name:"if",hash:{},fn:e.program(14,i,0),inverse:e.noop,data:i}))!=null?s:"")+'							<li class="menuitem"\n								role="menuitem"\n								aria-label="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.ORGANIZE"},data:i}))+'">\n								<a data-track="gnYouOrganizeClick" href="/photos/organize">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage"
,hash:{intlName:"global-nav.ORGANIZE"},data:i}))+"</a>\n							</li>\n						</ul>\n"},18:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a=e.escapeExpression;return'				<li class="toplink"\n					role="menuitem"\n					aria-label="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.CAMERAROLL"},data:i}))+'">\n					<a data-track="gnYouMainClick"\n					class="gn-link"\n					href="'+a(e.lambda((s=(s=t!=null?t.viewer:t)!=null?s.urls:s)!=null?s.cameraroll:s,t))+'"><span>'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.CAMERAROLL"},data:i}))+"</span></a>\n				</li>\n"},20:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a=e.escapeExpression;return'				<li role="menuitem"\n					data-context="explore"\n					aria-label="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"common.EXPLORE"},data:i}))+'">\n					<a data-track="gnExploreMainClick"\n						class="gn-title explore"\n						href="/explore"\n						aria-haspopup="true"\n						aria-expanded="false">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"common.EXPLORE"},data:i}))+'</a>\n					<ul class="gn-submenu" role="menu" aria-label="submenu">\n						<li role="menuitem"\n							aria-label="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.RECENT_PHOTOS"},data:i}))+'">\n							<a data-track="gnExploreRecentPhotosClick" href="/explore">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.RECENT_PHOTOS"},data:i}))+'</a></li>\n						<li role="menuitem"\n							aria-label="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"common.TRENDING"},data:i}))+'">\n							<a data-track="gnExploreTagsClick" href="/photos/tags">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"common.TRENDING"},data:i}))+"</a></li>\n"+((s=n["if"].call(o,t!=null?t.enableVRLanding:t,{name:"if",hash:{},fn:e.program(21,i,0),inverse:e.noop,data:i}))!=null?s:"")+'						<li role="menuitem"\n							aria-label="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.THE_COMMONS"},data:i}))+'">\n							<a data-track="gnExploreTheCommonsClick" href="/commons">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.THE_COMMONS"},data:i}))+'</a>\n						</li>\n						<li role="menuitem"\n							aria-label="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.GALLERIES"},data:i}))+'">\n							<a data-track="gnExploreGalleriesClick" href="/galleries">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.GALLERIES"},data:i}))+'</a>\n						</li>\n						<li role="menuitem"\n							aria-label="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.WORLD_MAP"},data:i}))+'">\n							<a data-track="gnExploreWorldMapClick" href="/map">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.WORLD_MAP"},data:i}))+'</a>\n						</li>\n						<li role="menuitem"\n							aria-label="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.CAMERA_FINDER"},data:i}))+'">\n							<a data-track="gnExploreCameraFinderClick" href="/cameras">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.CAMERA_FINDER"},data:i}))+"</a>\n						</li>\n"+((s=n["if"].call(o,(s=t!=null?t.elements:t)!=null?s.weekly_flickr:s,{name:"if",hash:{},fn:e.program(23,i,0),inverse:e.noop,data:i}))!=null?s:"")+'						<li role="menuitem"\n							aria-label="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.FLICKR_BLOG"},data:i}))+'">\n							<a data-track="gnExploreFlickrBlogClick" href="https://blog.flickr.net/">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.FLICKR_BLOG"},data:i}))+"</a>\n						</li>\n					</ul>\n				</li>\n"},21:function(e,t,n,r,i){return'							<li role="menuitem"\n								aria-label="Flickr VR">\n								<a data-track="gnExploreVRLandingClick" href="/vr">Flickr VR</a></li>\n'},23:function(e,t,n,r,i){var s=t!=null?t:{},o=n.helperMissing,u=e.escapeExpression;return'							<li role="menuitem"\n								aria-label="'+u((n.intlMessage||t&&t.intlMessage||o).call(s,{name:"intlMessage",hash:{intlName:"global-nav.THE_WEEKLY_FLICKR"},data:i}))+'">\n								<a data-track="gnExploreWeeklyFlickrClick" href="/photos/flickr/albums/72157639868074114/">'+u((n.intlMessage||t&&t.intlMessage||o).call(s,{name:"intlMessage",hash:{intlName:"global-nav.THE_WEEKLY_FLICKR"},data:i}))+"</a>\n							</li>\n"},25:function(e,t,n,r,i){var s=t!=null?t:{},o=n.helperMissing,u=e.escapeExpression;return'				<li role="menuitem"\n					class="gn-create"\n					aria-label="'+u((n.intlMessage||t&&t.intlMessage||o).call(s,{name:"intlMessage",hash:{intlName:"global-nav.CREATE"},data:i}))+'">\n					<a data-track="gnCreateMainClick"\n					class="gn-title"\n					href="/create">'+u((n.intlMessage||t&&t.intlMessage||o).call(s,{name:"intlMessage",hash:{intlName:"global-nav.CREATE"},data:i}))+"</a>\n				</li>\n"},27:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a=e.escapeExpression,f=e.lambda;return'				<li role="menuitem"\n					class="gn-create"\n					aria-haspopup="true"\n					aria-expanded="false"\n					aria-label="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.CREATE"},data:i}))+'">\n					<a data-track="gnCreateMainClick"\n					class="gn-title"\n					href="/create">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.CREATE"},data:i}))+'</a>\n\n					<ul class="gn-submenu" role="menu" aria-label="submenu">\n						<li role="menuitem"\n							aria-label="'+
a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.CREATE_NEW"},data:i}))+'">\n							<a data-track="gnCreateNew" href="/create">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.CREATE_NEW"},data:i}))+'</a></li>\n						<li role="menuitem"\n							aria-label="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.CREATE_MY_WALLART"},data:i}))+'">\n							<a data-track="gnCreateWallArt" href="'+a(f((s=(s=t!=null?t.viewer:t)!=null?s.urls:s)!=null?s.mywallart:s,t))+'">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.CREATE_MY_WALLART"},data:i}))+'</a></li>\n						<li role="menuitem"\n							aria-label="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.CREATE_MY_PHOTOS_BOOKS"},data:i}))+'">\n							<a data-track="gnCreatePhotoBooks" href="'+a(f((s=(s=t!=null?t.viewer:t)!=null?s.urls:s)!=null?s.myphotobooks:s,t))+'">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.CREATE_MY_PHOTOS_BOOKS"},data:i}))+'</a></li>\n						<li role="menuitem"\n							aria-label="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.CREATE_ORDER_HISTORY"},data:i}))+'">\n							<a data-track="gnCreateOrderHistory" href="'+a(f((s=(s=t!=null?t.viewer:t)!=null?s.urls:s)!=null?s.wallet:s,t))+'">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.CREATE_ORDER_HISTORY"},data:i}))+"</a></li>\n					</ul>\n				</li>\n\n"},29:function(e,t,n,r,i){return" with-upload-icon"},31:function(e,t,n,r,i){return" with-notifs-icon"},33:function(e,t,n,r,i){return" optimized-gn-tools-push-left"},35:function(e,t,n,r,i){var s=t!=null?t:{},o=n.helperMissing,u=e.escapeExpression;return'				<li class="gn-upload"\n					role="menuitem"\n					aria-label="'+u((n.intlMessage||t&&t.intlMessage||o).call(s,{name:"intlMessage",hash:{intlName:"global-nav.UPLOAD"},data:i}))+'">\n					<a data-track="gnUploadMain"\n					class="gn-title"\n					href="/upload">'+u((n.intlMessage||t&&t.intlMessage||o).call(s,{name:"intlMessage",hash:{intlName:"global-nav.UPLOAD"},data:i}))+"</a>\n				</li>\n"},37:function(e,t,n,r,i){var s,o=t!=null?t:{};return'				<li class="gn-search-box'+((s=n["if"].call(o,t!=null?t.enableWideSearchBar:t,{name:"if",hash:{},fn:e.program(38,i,0),inverse:e.noop,data:i}))!=null?s:"")+'"\n					role="menuitem">\n					<svg class="icon icon-search mobile-search-button">\n						<use xlink:href="#icon-search"></use>\n					</svg>\n\n'+((s=n["if"].call(o,t!=null?t.enableNewAutosugest:t,{name:"if",hash:{},fn:e.program(40,i,0),inverse:e.program(42,i,0),data:i}))!=null?s:"")+'\n					<svg class="mobile-search-close-button"><use xlink:href="#icon-close"></use></svg>\n				</li>\n'},38:function(e,t,n,r,i){return" optimized-search-box-wide"},40:function(e,t,n,r,i){return"							"+e.escapeExpression((n.outlet||t&&t.outlet||n.helperMissing).call(t!=null?t:{},t!=null?t["search-autosuggest-field-view"]:t,{name:"outlet",hash:{},data:i}))+"\n"},42:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a=e.escapeExpression;return'						<form method="get" role="search">\n							<input id="gn-search-field"\n								type="text"\n								placeholder="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"search.PHOTOS_PEOPLE_OR_GROUPS"},data:i}))+'"\n								name="text"\n								value="'+a((s=(s=n.searchValue||(t!=null?t.searchValue:t))!=null?s:u,typeof s=="function"?s.call(o,{name:"searchValue",hash:{},data:i}):s))+'"\n								autocomplete="off"\n								role="textbox"\n								aria-label="Search">\n							<label data-track="gnSearchSearchIcon"\n								aria-label="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.SEARCH"},data:i}))+'">\n								<svg class="search-icon"\n									style="width: 22px; height: 22px;"\n									data-track="gnSearchSearchIcon"\n									aria-label="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.SEARCH"},data:i}))+'">\n									<use xlink:href="#icon-search"></use>\n								</svg>\n								<input type="submit"\n									data-track="gnSearchSearchIcon"\n									class="search-icon-button"\n									tabindex="-1"\n									role="button"\n									aria-label="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.SEARCH"},data:i}))+'">\n							</label>\n						</form>\n'},44:function(e,t,n,r,i){var s=t!=null?t:{},o=n.helperMissing,u=e.escapeExpression;return'				<li class="gn-upload"\n					role="menuitem">\n					<a data-track="gnUploadIconMain"\n						class="gn-title"\n						href="/upload"\n						aria-label="'+u((n.intlMessage||t&&t.intlMessage||o).call(s,{name:"intlMessage",hash:{intlName:"global-nav.UPLOAD"},data:i}))+'">\n						<i class="upload-icon" title="'+u((n.intlMessage||t&&t.intlMessage||o).call(s,{name:"intlMessage",hash:{intlName:"global-nav.UPLOAD"},data:i}))+'" aria-hidden="true">'+u((n.intlMessage||t&&t.intlMessage||o).call(s,{name:"intlMessage",hash:{intlName:"global-nav.UPLOAD"},data:i}))+"</i>\n					</a>\n				</li>\n"},46:function(e,t,n,r,i){return'				<li role="menuitem">\n					'+e.escapeExpression((n.outlet||t&&t.outlet||n.helperMissing).call(t!=null?t:{},t!=null?t["notifications-menu-view"]:t,{name:"outlet",hash:{},data:i}))+"\n				</li>\n"},48:function(e,t,n,r,i){return'				<li role="menuitem">\n					'+e.escapeExpression((n.outlet||t&&t.outlet||n.helperMissing).call(t!=null?t:{},t!=null?t["account-menu-view"]:t,{name:"outlet",hash:{},data:i}))+"\n				</li>\n"},50:function(e,t,n,r,i){var s,o=t!=null?t:{};return'				<li class="gn-signin'+((s=n["if"].call(o,t!=null?t.enableWideSearchBar:t,{name:"if",hash:{},fn:e.program(51,i,0),inverse:e.noop,data:i}))!=null?s:"")+'"\n					role="menuitem"\n					aria-label="'+e.escapeExpression((
n.intlMessage||t&&t.intlMessage||n.helperMissing).call(o,{name:"intlMessage",hash:{intlName:"global-nav.SIGN_IN"},data:i}))+'">\n					<a data-track="gnSignin"\n						class="gn-title"\n						href="/signin">'+((s=n["if"].call(o,t!=null?t.enableWideSearchBar:t,{name:"if",hash:{},fn:e.program(53,i,0),inverse:e.program(56,i,0),data:i}))!=null?s:"")+"</a>\n				</li>\n"},51:function(e,t,n,r,i){return" optimized-login-set-width"},53:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.isEnglish:t,{name:"if",hash:{},fn:e.program(54,i,0),inverse:e.program(56,i,0),data:i}))!=null?s:""},54:function(e,t,n,r,i){return e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlName:"global-nav.LOG_IN"},data:i}))},56:function(e,t,n,r,i){return e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlName:"global-nav.SIGN_IN"},data:i}))},58:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},(s=t!=null?t.elements:t)!=null?s.right_side_signup:s,{name:"if",hash:{},fn:e.program(59,i,0),inverse:e.noop,data:i}))!=null?s:""},59:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a=e.escapeExpression;return'				<li class="gn-signup"\n					role="menuitem"\n					aria-label="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"common.SIGN_UP"},data:i}))+'">\n					<a data-track="gnSignupClick"\n						class="gn-title butt'+((s=n["if"].call(o,t!=null?t.enableWideSearchBar:t,{name:"if",hash:{},fn:e.program(60,i,0),inverse:e.noop,data:i}))!=null?s:"")+'"\n						href="/signup">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"common.SIGN_UP"},data:i}))+"</a>\n				</li>\n"},60:function(e,t,n,r,i){return" optimized-signup-light-font"},62:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a=e.escapeExpression,f=e.lambda;return'				<div class="mobile-nav-column">\n					<div class="mobile-nav-menu-item mobile-nav-menu-title">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"common.YOU"},data:i}))+'</div>\n					<div class="mobile-nav-menu-item"><a data-track="gnYouCameraRollClick" href="'+a(f((s=(s=t!=null?t.viewer:t)!=null?s.urls:s)!=null?s.cameraroll:s,t))+'">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.CAMERAROLL"},data:i}))+'</a></div>\n					<div class="mobile-nav-menu-item"><a data-track="gnYouPhotostreamClick" href="'+a(f((s=t!=null?t.viewer:t)!=null?s.url:s,t))+'">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"common.PHOTOSTREAM"},data:i}))+'</a></div>\n					<div class="mobile-nav-menu-item"><a data-track="gnYouSetsClick" href="'+a(f((s=(s=t!=null?t.viewer:t)!=null?s.urls:s)!=null?s.albums:s,t))+'">'+((s=n["if"].call(o,(s=t!=null?t.elements:t)!=null?s.set_not_album:s,{name:"if",hash:{},fn:e.program(10,i,0),inverse:e.program(12,i,0),data:i}))!=null?s:"")+'</a></div>\n					<div class="mobile-nav-menu-item"><a data-track="gnYouFavoritesClick" href="'+a(f((s=(s=t!=null?t.viewer:t)!=null?s.urls:s)!=null?s.favorites:s,t))+'">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"common.FAVORITES"},data:i}))+'</a></div>\n					<div class="mobile-nav-menu-item"><a data-track="gnYouGroupsClick" href="/groups">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.GROUPS"},data:i}))+'</a></div>\n					<div class="mobile-nav-menu-item"><a data-track="gnYouGalleriesClick" href="'+a(f((s=(s=t!=null?t.viewer:t)!=null?s.urls:s)!=null?s.galleries:s,t))+'">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"common.GALLERIES"},data:i}))+'</a></div>\n					<div class="mobile-nav-menu-item"><a data-track="gnYouRecentActivityClick" href="/activity">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.RECENT_ACTIVITY"},data:i}))+"</a></div>\n					"+((s=n["if"].call(o,(s=t!=null?t.elements:t)!=null?s.stats:s,{name:"if",hash:{},fn:e.program(63,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n				</div>\n"},63:function(e,t,n,r,i){var s,o=e.escapeExpression;return'<div class="mobile-nav-menu-item"><a data-track="gnYouStatsClick" href="'+o(e.lambda((s=(s=t!=null?t.viewer:t)!=null?s.urls:s)!=null?s.stats:s,t))+'">'+o((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlName:"global-nav.STATS"},data:i}))+"</a></div>"},65:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a=e.escapeExpression;return'				<div class="mobile-nav-column">\n					<div class="mobile-nav-menu-item"><a data-track="gnExploreMainClick" class="explore" href="/explore" aria-haspopup="true">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"common.EXPLORE"},data:i}))+'</a></div>\n					<div class="mobile-nav-menu-item"><a data-track="gnExploreRecentPhotosClick" href="/explore">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.RECENT_PHOTOS"},data:i}))+'</a></div>\n					<div class="mobile-nav-menu-item"><a data-track="gnExploreTagsClick" href="/photos/tags">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"common.TRENDING"},data:i}))+'</a></div>\n					<div class="mobile-nav-menu-item"><a data-track="gnExploreTheCommonsClick" href="/commons">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.THE_COMMONS"},data:i}))+'</a></div>\n					<div class="mobile-nav-menu-item"><a data-track="gnExploreGalleriesClick" href="/galleries">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.GALLERIES"},data:i}))+"</a></div>\n					"+((s=n["if"].call(o,(s=t!=null?t.elements:t)!=null?s.weekly_flickr:s,{name:"if",hash:{},fn:e.program(66,i,0),inverse:e.noop,data:i}))!=null?s:"")+'\n					<div class="mobile-nav-menu-item"><a data-track="gnExploreFlickrBlogClick" href="https://blog.flickr.net/">'+
a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.FLICKR_BLOG"},data:i}))+"</a></div>\n				</div>\n"},66:function(e,t,n,r,i){return'<div class="mobile-nav-menu-item"><a data-track="gnExploreWeeklyFlickrClick" href="/photos/flickr/albums/72157639868074114/">'+e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlName:"global-nav.THE_WEEKLY_FLICKR"},data:i}))+"</a></div>"},68:function(e,t,n,r,i){return"	"+e.escapeExpression((n.outlet||t&&t.outlet||n.helperMissing).call(t!=null?t:{},t!=null?t["browser-upgrade-banner-view"]:t,{name:"outlet",hash:{},data:i}))+"\n"},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a=e.escapeExpression;return a((n.outlet||t&&t.outlet||u).call(o,t!=null?t["mobile-app-upsell-view"]:t,{name:"outlet",hash:{},data:i}))+'\n\n<div class="global-nav-restyle">\n<div class="global-nav-shim"></div>\n<div class="global-nav-content styleguide-global-nav fluid sohp-mobile-navable">\n	<div class="global-nav-container fluid-centered" role="navigation" aria-label="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"common.MAIN"},data:i}))+'">\n		<div class="mobile-nav-toggle'+((s=n["if"].call(o,t!=null?t.enableWideSearchBar:t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))!=null?s:"")+'"><span></span></div>\n\n		<div class="flickr-logo-container'+((s=n["if"].call(o,t!=null?t.enableWideSearchBar:t,{name:"if",hash:{},fn:e.program(3,i,0),inverse:e.noop,data:i}))!=null?s:"")+'">\n			<a href="/"\n				class="main-logo"\n				data-track="gnLogoClick"\n				title="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.FLICKR_LOGO_ALT"},data:i}))+'"\n				role="heading"\n				aria-level="1"\n				aria-label="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"global-nav.FLICKR_LOGO_ALT"},data:i}))+'">\n				<svg class="icon-flickr"><use xlink:href="#icon-flickr_logo"></use></svg>\n			</a>\n		</div>\n\n		<ul class="nav-menu" role="menubar">\n'+((s=n["if"].call(o,(s=t!=null?t.elements:t)!=null?s.signup_link:s,{name:"if",hash:{},fn:e.program(5,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n"+((s=n["if"].call(o,(s=t!=null?t.elements:t)!=null?s.you_menu:s,{name:"if",hash:{},fn:e.program(8,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n"+((s=n["if"].call(o,(s=t!=null?t.elements:t)!=null?s.you_link:s,{name:"if",hash:{},fn:e.program(18,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n"+((s=n["if"].call(o,(s=t!=null?t.elements:t)!=null?s.explore_menu:s,{name:"if",hash:{},fn:e.program(20,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n"+((s=n["if"].call(o,(s=t!=null?t.elements:t)!=null?s.create_link:s,{name:"if",hash:{},fn:e.program(25,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n"+((s=n["if"].call(o,(s=t!=null?t.elements:t)!=null?s.create_menu:s,{name:"if",hash:{},fn:e.program(27,i,0),inverse:e.noop,data:i}))!=null?s:"")+'		</ul>\n\n		<ul class="gn-tools'+((s=n["if"].call(o,(s=t!=null?t.elements:t)!=null?s.upload_icon:s,{name:"if",hash:{},fn:e.program(29,i,0),inverse:e.noop,data:i}))!=null?s:"")+((s=n["if"].call(o,t!=null?t.showNotificationsMenu:t,{name:"if",hash:{},fn:e.program(31,i,0),inverse:e.noop,data:i}))!=null?s:"")+((s=n["if"].call(o,t!=null?t.enableWideSearchBar:t,{name:"if",hash:{},fn:e.program(33,i,0),inverse:e.noop,data:i}))!=null?s:"")+'"\n			role="menubar">\n'+((s=n["if"].call(o,(s=t!=null?t.elements:t)!=null?s.upload_link:s,{name:"if",hash:{},fn:e.program(35,i,0),inverse:e.noop,data:i}))!=null?s:"")+((s=n["if"].call(o,(s=t!=null?t.elements:t)!=null?s.search_bar:s,{name:"if",hash:{},fn:e.program(37,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n"+((s=n["if"].call(o,(s=t!=null?t.elements:t)!=null?s.upload_icon:s,{name:"if",hash:{},fn:e.program(44,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n"+((s=n["if"].call(o,t!=null?t.showNotificationsMenu:t,{name:"if",hash:{},fn:e.program(46,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n"+((s=n["if"].call(o,(s=t!=null?t.elements:t)!=null?s.account_menu:s,{name:"if",hash:{},fn:e.program(48,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n"+((s=n["if"].call(o,(s=t!=null?t.elements:t)!=null?s.signin_link:s,{name:"if",hash:{},fn:e.program(50,i,0),inverse:e.noop,data:i}))!=null?s:"")+((s=n["if"].call(o,(s=t!=null?t.elements:t)!=null?s.signup_link:s,{name:"if",hash:{},fn:e.program(58,i,0),inverse:e.noop,data:i}))!=null?s:"")+'		</ul>\n\n		<div class="mobile-nav">\n'+((s=n["if"].call(o,(s=t!=null?t.elements:t)!=null?s.you_menu:s,{name:"if",hash:{},fn:e.program(62,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n"+((s=n["if"].call(o,(s=t!=null?t.elements:t)!=null?s.explore_menu:s,{name:"if",hash:{},fn:e.program(65,i,0),inverse:e.noop,data:i}))!=null?s:"")+"		</div>\n	</div>\n</div>\n\n"+((s=n["if"].call(o,t!=null?t["show-browser-upgrade-banner"]:t,{name:"if",hash:{},fn:e.program(68,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n"+a((n.outlet||t&&t.outlet||u).call(o,t!=null?t["person-menu-view"]:t,{name:"outlet",hash:{},data:i}))+"\n"+a((n.outlet||t&&t.outlet||u).call(o,t!=null?t["group-menu-view"]:t,{name:"outlet",hash:{},data:i}))+"\n"+a((n.outlet||t&&t.outlet||u).call(o,t!=null?t["signup-rail-view"]:t,{name:"outlet",hash:{},data:i}))+"\n</div>\n"},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/global-nav-restyle",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("search-helper",function(e){function b(e){return!e[r.userId]&&!e[r.groupId]&&!e[r.tags]&&!e[r.text]&&!e[r.license]&&!e[r.faves]&&!e[r.contacts]&&!e[r.getty]&&!e[r.commons]&&!e[r.minTakenDate]&&!e[r.maxTakenDate]&&!e[r.minUploadDate]&&!e[r.maxUploadDate]&&!e[r.hasGeo]&&!e[r.boundingBox]&&!e[r.woeId]&&!e[r.camera]&&!e[r.minExposure]&&!e[r.maxExposure]&&!e[r.minAperture]&&!e[r.maxAperture]&&!e[r.minFocalLength]&&!e[r.maxFocalLength]&&!e[r.foursquareWoeId]&&!e[r.foursquareVenueId]&&!e[u.username]&&!e[r.similarityId]}function w(e,t){var n;for(n in c){if(!t&&n===e)return c[n];if(t&&c[n]===e)return n}}function E(e){var n={nsid_or_path_alias:"userId",group_id:"groupId",set_id:"setId",page_number:"page",tag_list:"tags",location:"text",slideshow_start_id:"slideshowStartId"},i,s={};for(i in n)e[i]&&(s[r[n[i]]]=e[i]);return s[r.groupId]&&!t.nsid(s[r.groupId])&&(s[r.groupPathAlias]=s[r.groupId],delete s[r.groupId]),s}function S(e,t){var n={},r=null,s=t.getViewer();e=e||{},e.q&&(n[u.username]=e.q);if(e.s)switch(e.s){case"age":n[u.sort]=i.oldestJoined;break;case"pho":n[u.sort]=i.mostPhotos}e.see&&e.see.toString().toLowerCase()==="all"&&s.signedIn&&(n[u.userId]=s.nsid),e.m&&(e.m.toString().toLowerCase()==="extras",e.m.toString().toLowerCase()==="names");for(r in e)o.indexOf(r)===-1&&(n[r]=e[r]);return n}function x(e,t){var n={},r=null,s;e=e||{},s=e.m&&e.m.toString().toLowerCase()==="discuss",e.q&&(n[f.text]=e.q),s;if(e.s)switch(e.s){case"act":s?n[f.sort]=i.discussionActivity:n[f.sort]=i.activity;break;case"siz":n[f.sort]=i.size;break;case"age":n[f.sort]=i.newest;break;case"rep":}for(r in e)a.indexOf(r)===-1&&(n[r]=e[r]);return n}function T(s,o){if(!s)return{};var u={},a,f,l=o.getViewer(),h=s.l,p=s.s,d=s.w,v,m=s.m,g=s.q,y;s.d&&typeof s.d=="string"&&(v=s.d.split("-")),s.q&&(u[r.text]=s.q),typeof s["ss"]!="undefined"&&(u[r.safeSearch]=parseInt(s.ss,10)+1),typeof s["ct"]!="undefined"&&(u[r.contentType]=parseInt(s.ct,10)+1),typeof s["mt"]!="undefined"&&(u[r.mediaType]=s.mt),s.b&&(u[r.boundingBox]=s.b),s.a&&(u[r.accuracy]=s.a),s.e&&(u[r.woeId]=s.e),s.g&&(u[r.groupId]=s.g),s.cm&&(u[r.camera]=s.cm),typeof s["xel"]!="undefined"&&(u[r.minExposure]=s.xel),typeof s["xeh"]!="undefined"&&(u[r.maxExposure]=s.xeh),typeof s["xal"]!="undefined"&&(u[r.minAperture]=s.xal),typeof s["xah"]!="undefined"&&(u[r.maxAperture]=s.xah),typeof s["xfl"]!="undefined"&&(u[r.minFocalLength]=s.xfl),typeof s["xfh"]!="undefined"&&(u[r.maxFocalLength]=s.xfh),s.eui&&(u[r.excludeUserId]=s.eui);if(typeof h!="undefined")switch(h){case"cc":case"comm":case"deriv":case"commderiv":u[r.license]=c[h];break;default:f=parseInt(h,10),f>=0&&f<=10&&(u[r.license]=f)}if(p)switch(p){case"rec":u[r.sort]=i.recent;break;case"rel":u[r.sort]=i.relevant;break;case"int":u[r.sort]=i.interesting;break;default:}s.hd&&(u[r.media]="hdvideo");if(d&&typeof d=="string")if(d.indexOf("faves")!==-1)y=d.split("-"),u[r.faves]=1,y.length>1?u[r.userId]=y[1]:l.signedIn&&(u[r.userId]=l.nsid);else if(t.nsid(d))m==="pool"?u[r.groupId]=d:u[r.userId]=d;else switch(d){case"contacts":u[r.contacts]="all";break;case"ff":u[r.contacts]="ff";break;case"getty":u[r.getty]="true";break;case"commons":u[r.commons]="true";break;case"usg":u[r.license]=8;break;case"all":default:}if(v)switch(v[0]){case"taken":v[1]&&(u[r.minTakenDate]=e.flutil.parseYYYYMMDDDatestamp(v[1])/1e3),v[2]&&(u[r.maxTakenDate]=e.flutil.parseYYYYMMDDDatestamp(v[2])/1e3);break;case"posted":v[1]&&(u[r.minUploadDate]=e.flutil.parseYYYYMMDDDatestamp(v[1])/1e3),v[2]&&(u[r.maxUploadDate]=e.flutil.parseYYYYMMDDDatestamp(v[2])/1e3);break;default:}if(m&&g)switch(m){case"tags":u=e.merge(u,this.processTags(g)),delete u[r.text];break;default:}for(a in s)n.indexOf(a)===-1&&(u[a]=s[a]);return u}function N(e){var t={},n=e[r.userId];return e[r.text]?t.q=e[r.text]:e[r.tags]&&(t.q=e[r.tags]),e[r.faves]?n?t.w="faves-"+n:t.w="faves":n?t.w=n:e[r.contacts]==="all"?t.w="contacts":e[r.contacts]==="ff"?t.w="ff":e[r.getty]==="true"?t.w="getty":e[r.commons]==="true"?t.w="commons":parseInt(e[r.license],10)===8&&(t.w="usg"),e[r.license]&&(t.l=w(e[r.license],!0)),t}function C(e,t){e[r.license]&&(e[r.license]===c.all||e[r.license]==="")&&delete e[r.license]}function k(e){}function L(e){}function A(e,t){for(var n in e)t.indexOf(n)===-1&&delete e[n]}function O(e){this.clearParams(e,g)}function M(e){this.clearParams(e,m)}function _(t){var n=e.clone(t)||{};return delete n.page,delete n.method,delete n.extras,e.QueryString.stringify(n)}function D(t){var n=t[r.groupId],i=t[r.tags],s=t[r.text];YUI.Env.isServer&&(n&&(t[r.groupId]=e.flutil.unescape(n)),i&&(t[r.tags]=e.flutil.unescape(i)),s&&(t[r.text]=e.flutil.unescape(s)))}function P(e){var t=0;return e.photos&&!e.screenshots&&!e.other?t=1:!e.photos&&e.screenshots&&!e.other?t=2:!e.photos&&!e.screenshots&&e.other?t=3:e.photos&&e.screenshots&&!e.other?t=4:!e.photos&&e.screenshots&&e.other?t=5:e.photos&&!e.screenshots&&e.other?t=6:e.photos&&e.screenshots&&e.other&&(t=7),t}function H(e){var t={},n=parseInt(e,10);switch(n){case 1:t.photos=!0;break;case 2:t.screenshots=!0;break;case 3:t.other=!0;break;case 4:t.photos=!0,t.screenshots=!0;break;case 5:t.other=!0,t.screenshots=!0;break;case 6:t.photos=!0,t.other=!0;break;default:t.photos=!0,t.screenshots=!0,t.other=!0}return t}function B(t){var n=e.AttributeHelpers.coerceInteger(t);return e.AttributeHelpers.coerceString(n+1)}function j(n,i){var s=i.getViewer(),o;return n[r.userId]?s&&s.signedIn&&s.nsid===n[r.userId]?n[r.faves]?e.Promise.resolve({intlName:"search.VIEWER_FAVES"}):e.Promise.resolve({intlName:"search.YOUR_PHOTOS"}):(t.nsid(n[r.userId])?o=n[r.userId]:o={pathAlias:n[r.userId]},i.getModel("person-models",o).then(function(e){var t;return n[r.faves]?t="search.FAVES_POSSESSIVE":t="search.PHOTOS_POSSESSIVE",{intlName:t,name:e.getValue("displayname")}})):n[r.contacts]?e.Promise.resolve({intlName:"search.FROM_PEOPLE_YOU_FOLLOW"}):n[r.groupId]||n[r.groupPathAlias]?(n[r.groupId]?o={id:n[r.groupId]}:o={pathAlias:n[r.groupPathAlias]},i.getModel("group-info-models",o).then
(function(e){return{intlName:"search.IN_GROUP_POOL",name:e.getValue("group").getValue("title")}})):n[r.faves]?e.Promise.resolve({intlName:"search.VIEWER_FAVES"}):e.Promise.resolve({intlName:"search.EVERYONES_PHOTOS"})}function F(n,i){var s=i.getViewer(),o;if(n[r.userId])return s&&s.signedIn&&s.nsid===n[r.userId]?e.Promise.resolve({intlName:"search.PEOPLE_YOU_FOLLOW"}):(t.nsid(n[r.userId])?o=n[r.userId]:o={pathAlias:n[r.userId]},i.getModel("person-models",o).then(function(e){return{intlName:"search.CONTACTS_POSSESSIVE",name:e.getValue("username")}}))}function I(n,i){var s=i.getViewer(),o;if(n[r.userId])return s&&s.signedIn&&s.nsid===n[r.userId]?e.Promise.resolve({intlName:"search.YOUR_GROUPS"}):(t.nsid(n[r.userId])?o=n[r.userId]:o={pathAlias:n[r.userId]},i.getModel("person-models",o).then(function(e){return{intlName:"search.GROUPS_POSSESSIVE",name:e.getValue("username")}}))}function q(e){e||(e={});var t=null,n=e[r.license];if(n&&n.length===1)switch(parseInt(n,10)){case 1:t="search.CC_BY_NC_SA";break;case 2:t="search.CC_BY_NC";break;case 3:t="search.CC_BY_NC_ND";break;case 4:t="search.CC_BY";break;case 5:t="search.CC_BY_SA";break;case 6:t="search.CC_BY_ND"}return t?{intlName:t}:null}function R(t,n,r){var i,s,o=this;return t===n?!0:r<=0?!1:(r=r||1,!e.Lang.isObject(t)||!e.Lang.isObject(n)?!1:(i=Object.keys(t),s=Object.keys(n),i.length!==s.length?!1:i.every(function(e){return o.objectsAreEquivalentToDepth(t[e],n[e],r-1)})))}function U(e){var t;return e&&(t=e.replace(/[\s!-\/:-@[-`]/g,"")),t}function z(e,t){if(!e||typeof e!="string")return{};var n={},i=/(["'])(\\?.)*?\1/g,s=/[,\+\s]/,o=/^([,\+]|AND|OR)$/,u=/[\+\s]OR[\+\s]/,a,f,l,c;return a=e.match(i)||[],f=e.replace(i,""),l=f.split(s),l=l.map(function(e){return e.trim()}).filter(function(e){return e&&!o.test(e)}),c=a.concat(l),n[r.tags]=c.join(","),t==="any"||t==="all"?n[r.tagMode]=t:u.test(e)?(n[r.tagMode]="any",c.length=Math.min(c.length,11)):n[r.tagMode]="all",n}var t=require("lib/helpers/type-validator"),n=["q","ss","ct","mt","l","s","w","d","m","hd","b","a","g","e","cm","xel","xeh","xal","xah","xfl","xfh","eui"],r={userId:"user_id",groupId:"group_id",groupPathAlias:"group_path_alias",setId:"set_id",page:"page",text:"text",tags:"tags",tagMode:"tag_mode",sort:"sort",safeSearch:"safe_search",contentType:"content_type",mediaType:"media",license:"license",faves:"faves",contacts:"contacts",getty:"is_getty",commons:"is_commons",marketplace:"marketplace_licensable",minTakenDate:"min_taken_date",maxTakenDate:"max_taken_date",minUploadDate:"min_upload_date",maxUploadDate:"max_upload_date",hasGeo:"has_geo",boundingBox:"bbox",accuracy:"accuracy",woeId:"woe_id",camera:"camera",minExposure:"exif_min_exposure",maxExposure:"exif_max_exposure",minAperture:"exif_min_aperture",maxAperture:"exif_max_aperture",minFocalLength:"exif_min_focallen",maxFocalLength:"exif_max_focallen",excludeUserId:"exclude_user_id",foursquareWoeId:"foursquare_woeid",foursquareVenueId:"foursquare_venueid",slideshowStartId:"jump_to",height:"height",width:"width",dimensionSearchMode:"dimension_search_mode",orientation:"orientation",colorCodes:"color_codes",styles:"styles",similarityId:"similarity_id"},i={relevant:"relevance",recent:"date-posted-desc",interesting:"interestingness-desc",name:"exact-name-match-first",activity:"most-activity",size:"most-members",oldest:"oldest-first",newest:"recent-first",oldestJoined:"age",mostPhotos:"pho",dateUploaded:"date-posted-desc",dateTaken:"date-taken-desc"},s={portrait:"portrait",square:"square",landscape:"landscape",panorama:"panorama"},o=["s","q","see","m"],u={username:"username",userId:"user_id",sort:"sort"},a=["q","s","m"],f={text:"text",sort:"sort",safeSearch:"safe_search",userId:"user_id",subscriptionTypes:"subscription_types",filterInactive:"filter_inactive_groups"},l={safe:1,all:2,eighteenPlusOnly:3},c={all:"0,1,2,3,4,5,6,7,8,9,10",cc:"1,2,3,4,5,6,9",deriv:"1,2,4,5,9,10",comm:"4,5,6,9,10",commderiv:"4,5,9,10"},h={viewAll:"view_all",viewType:"view_type",advanced:"advanced",albums:"album_search"},p=[r.tags,r.tagMode,r.mediaType,r.minTakenDate,r.maxTakenDate,r.minUploadDate,r.maxUploadDate,r.height,r.width,r.dimensionSearchMode,r.orientation,r.marketplace,r.excludeUserId],d=[r.colorCodes,r.styles],v=[r.sort,r.safeSearch,r.license],m=[r.userId,r.groupId,r.faves,r.contacts,r.commons,"m","w"],g=[r.userId,r.groupId,r.faves,r.contacts,r.safeSearch,r.sort,r.license,r.tags,r.text],y={sort:i.relevant,parse_tags:"1",content_type:"7"};e.SearchHelper={API:r,PEOPLE_SEARCH_API:u,GROUPS_SEARCH_API:f,GROUPS_SAFE_SEARCH_SETTINGS:l,API_SORT_OPTIONS:i,API_ORIENTATION_OPTIONS:s,LICENSE_TYPE:c,UNIFIED_STATE_PARAMS:h,UNIFIED_ADVANCED_PARAMS:p,UNIFIED_QUICK_FILTER_PARAMS:d,UNIFIED_TOOLBAR_PARAMS:v,SEARCH_SCOPE_PARAMS:m,UNIFIED_DEFAULT_PARAMS:y,decodeContentType:H,encodeContentType:P,isParameterlessSearch:b,mapRouteParamsToAPI:E,convertLicenseTypeValue:w,mapClassicSearchToAPI:T,mapClassicPeopleSearchToAPI:S,mapClassicGroupSearchToApi:x,mapAPIParamsToAdvancedSearchQuery:N,deriveScopeTitle:j,derivePeopleScopeTitle:F,deriveGroupsScopeTitle:I,deriveCCLicenseString:q,addParamDefaults:C,addGroupsParamDefaults:k,addPeopleParamDefaults:L,clearParams:A,clearAdvancedSearchParams:O,clearParamsExceptSearchScope:M,generateQueryString:_,convertSafeSearchPrefsToApi:B,unescapeParameters:D,objectsAreEquivalentToDepth:R,normalizeTag:U,processTags:z}},"@VERSION@",{requires:["flutil"]});
YUI.add("search-url",function(e,t){function u(e){return typeof e=="number"?e.toString():typeof e=="boolean"?e?"1":"0":typeof e=="string"?e:undefined}var n=require("lib/flog")(t),r,i,s=/^\/search(?:\/.*)?$/,o=/^bw|blackandwhite$/;YUI.Env.isServer?r=require("querystring").stringify:r=e.QueryString.stringify,i=function(t,r,s){var o,a,f,l,c;this.appContext=r;if(typeof t=="string"){c=t.split("?"),s?this.searchType=s:(a=c[0].split("/"),a[0].indexOf("http")!==-1?f=3:f=1,l="/"+a.slice(f).join("/"),this.searchType=this.getSearchTypeFromPathname(l)),c=c.length>1?c[1]:"",this.params={};if(c)try{c=e.QueryString.parse(c),this.params=e.SearchHelper.mapClassicSearchToAPI(c,r)}catch(h){n.warn("malformed query",{err:h,query:c})}}else this.params=e.merge(t),this.searchType=s;for(o in this.params)this.params.hasOwnProperty(o)&&(this.params[o]=u(this.params[o]));this.params.color_codes&&(this.colors=this.params.color_codes.toString().split(",")),this.searchType||this.setSearchType(i.searchTypes.UNDEFINED)},i.prototype.setSearchType=function(t){var n=this.getSearchTerm();return this.searchType=t,this.params=this.validateParams(this.params,this.searchType),this.params=e.merge(this.getDefaultParams(this.searchType),this.params),n&&this.setSearchTerm(n),this},i.prototype.getSearchTypeFromPathname=function(e){e=e||this.pathname,e=e.toLowerCase(),e=e.split("/").join("");switch(e){case"searchpeople":return i.searchTypes.PEOPLE;case"searchgroups":return i.searchTypes.GROUPS;case"search":default:return i.searchTypes.PHOTOS}},i.prototype.getPathname=function(){var e="/search/";switch(this.searchType){case i.searchTypes.PEOPLE:e+="people/";break;case i.searchTypes.GROUPS:e+="groups/";break;case i.searchTypes.CLASSIC_GROUPS:e="/search_groups.gne";break;case i.searchTypes.PHOTOS:default:}return e},i.prototype.validateParams=function(t,n){var r,s={},o,u;t=e.merge(t);switch(n){case i.searchTypes.PEOPLE:r=e.merge(e.SearchHelper.PEOPLE_SEARCH_API),r.text="text";break;case i.searchTypes.GROUPS:r=e.merge(e.SearchHelper.GROUPS_SEARCH_API);break;case i.searchTypes.PHOTOS:r=e.merge(e.SearchHelper.API,e.SearchHelper.UNIFIED_STATE_PARAMS);break;case i.searchTypes.UNDEFINED:default:return t}if(r)for(o in r)u=r[o],typeof t[u]!="undefined"&&(s[u]=t[u]);return s},i.prototype.getDefaultParams=function(t){var n={};switch(t){case i.searchTypes.PEOPLE:e.SearchHelper.addPeopleParamDefaults(n);break;case i.searchTypes.GROUPS:e.SearchHelper.addGroupsParamDefaults(n);break;case i.searchTypes.PHOTOS:e.SearchHelper.addParamDefaults(n);break;case i.searchTypes.UNDEFINED:default:}return n},i.prototype.getAPIParams=function(){return e.merge(this.params)},i.prototype.getAPIParam=function(e){return this.params[e]},i.prototype.setAPIParam=function(e,t){return this.params[e]=u(t),this},i.prototype.removeAPIParam=function(e){return delete this.params[e],this},i.prototype.removeAllAPIParams=function(){return this.params={},this},i.prototype.getSearchTerm=function(){var t=this.params[this.getSearchTermKey(this.searchType)];return t||(t=this.params[e.SearchHelper.API.tags]),t||""},i.prototype.setSearchTerm=function(t){var n=this.getSearchTermKey(this.searchType);return delete this.params[e.SearchHelper.PEOPLE_SEARCH_API.username],delete this.params[e.SearchHelper.GROUPS_SEARCH_API.text],delete this.params[e.SearchHelper.API.text],delete this.params[e.SearchHelper.API.tags],delete this.params.q,this.params[n]=t,this},i.prototype.getSearchTermKey=function(t){switch(t){case i.searchTypes.PEOPLE:return e.SearchHelper.PEOPLE_SEARCH_API.username;case i.searchTypes.GROUPS:return e.SearchHelper.GROUPS_SEARCH_API.text;case i.searchTypes.PHOTOS:default:return this.params[e.SearchHelper.API.tags]||this.params[e.SearchHelper.API.tags]===""?e.SearchHelper.API.tags:e.SearchHelper.API.text}},i.prototype.removeScope=function(){return e.SearchHelper.SEARCH_SCOPE_PARAMS.forEach(function(e){this.removeAPIParam(e)}.bind(this)),this.removeAPIParam(e.SearchHelper.API.excludeUserId),this},i.prototype.resetToUnified=function(){return this.params[e.SearchHelper.UNIFIED_STATE_PARAMS.viewAll]&&(this.removeAPIParam(e.SearchHelper.API.userId),this.removeAPIParam(e.SearchHelper.API.contacts),this.removeAPIParam(e.SearchHelper.API.groupId),this.removeAPIParam(e.SearchHelper.UNIFIED_STATE_PARAMS.albums)),this.removeAPIParam(e.SearchHelper.API.similarityId),this.removeAPIParam(e.SearchHelper.UNIFIED_STATE_PARAMS.viewAll),this},i.prototype.hasAdvancedParams=function(t){return Object.keys(this.params).some(function(n){return e.SearchHelper.UNIFIED_ADVANCED_PARAMS.indexOf(n)!==-1||!t&&e.SearchHelper.UNIFIED_QUICK_FILTER_PARAMS.indexOf(n)!==-1||!t&&e.SearchHelper.UNIFIED_TOOLBAR_PARAMS.indexOf(n)!==-1})},i.prototype.resetAdvancedParam=function(t,n){return this.hasAdvancedParams(t)?this.setAPIParam(e.SearchHelper.UNIFIED_STATE_PARAMS.advanced,1):n||this.removeAPIParam(e.SearchHelper.UNIFIED_STATE_PARAMS.advanced),this},i.prototype.createNewSearch=function(e){this.setSearchTerm(e),this.removeScope();if(this.searchType===i.searchTypes.UNDEFINED||this.searchType===i.searchTypes.PHOTOS)this.resetToUnified(),this.resetAdvancedParam();return this},i.prototype.getURL=function(){var e=this.getId(),t=this.getPathname();return e===i.EMPTY_SEARCH_ID?t:t+"?"+e},i.prototype.getId=function(){var t={},n,s=e.SearchHelper.API;for(n in this.params)s[n]?t[s[n]]=this.params[n]:t[n]=this.params[n];return r(t)||i.EMPTY_SEARCH_ID},i.prototype.clone=function(){var e=new i(this.params,this.appContext,this.searchType);return e},i.prototype.setMedia=function(t,n){var r;t||(t=!1),n||(n=!1),t&&n?r="all":t?r="photos":r="videos",this.setAPIParam(e.SearchHelper.API.mediaType,r)},i.prototype._syncColors=function(){this.colors&&this.colors.length>0?this.params.color_codes=this.colors.join(","):this.removeAPIParam("color_codes")},i.prototype.addColorCode=function(e){if(e&&e.match(o)){this.clearColorCodes(),this.colors=["bw"],this._syncColors();return}this.colors&&this.colors.indexOf("bw")!==-1&&(this.colors=[]),this.colors||(this
.colors=[]),this.colors.indexOf(e)===-1&&(this.colors.push(e),this._syncColors())},i.prototype.removeColorCode=function(e){var t;this.colors&&(t=this.colors.indexOf(e),t!==-1&&(this.colors.splice(t,1),this._syncColors()))},i.prototype.clearColorCodes=function(){this.colors=[],this._syncColors()},i.isSearchUrl=function(e){return s.test(e)},i.searchTypes={UNDEFINED:0,PHOTOS:1,PEOPLE:2,GROUPS:3,CLASSIC_GROUPS:4},i.EMPTY_SEARCH_ID="-1",e.SearchUrl=i},"@VERSION@",{requires:["search-helper","querystring-parse-simple","querystring-stringify-simple"]});
YUI.add("hermes-template-search-pill",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){var s,o,u=t!=null?t:{},a=n.helperMissing,f=e.escapeExpression;return'<li class="search-pill" '+((s=n["if"].call(u,t!=null?t.id:t,{name:"if",hash:{},fn:e.program(2,i,0),inverse:e.noop,data:i}))!=null?s:"")+">"+f((n.truncate||t&&t.truncate||a).call(u,t!=null?t.name:t,20,{name:"truncate",hash:{},data:i}))+'<div class="search-pill-divider"></div>'+f((o=(o=n.secondName||(t!=null?t.secondName:t))!=null?o:a,typeof o=="function"?o.call(u,{name:"secondName",hash:{},data:i}):o))+'<i class="search-pill-remover"></i></li>\n'},2:function(e,t,n,r,i){var s;return"id="+e.escapeExpression((s=(s=n.id||(t!=null?t.id:t))!=null?s:n.helperMissing,typeof s=="function"?s.call(t!=null?t:{},{name:"id",hash:{},data:i}):s))},4:function(e,t,n,r,i){var s,o=t!=null?t:{};return'<li class="search-pill" '+((s=n["if"].call(o,t!=null?t.id:t,{name:"if",hash:{},fn:e.program(2,i,0),inverse:e.noop,data:i}))!=null?s:"")+">"+e.escapeExpression((n.truncate||t&&t.truncate||n.helperMissing).call(o,t!=null?t.name:t,30,{name:"truncate",hash:{},data:i}))+'<i class="search-pill-remover"></i></li>\n'},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.combo:t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.program(4,i,0),data:i}))!=null?s:""},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/search-pill",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
